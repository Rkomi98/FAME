{% extends "base.html" %}
{% block content %}
  <div class="mt-4">
    <h2>Ciao, {{ current_user.username }}!</h2>
    <p class="lead">Benvenuto nella tua dashboard personalizzata.</p>
    <hr>
    <div class="row">
      <div class="col-md-6">
        <h4>La tua dieta pi√π recente</h4>
        {% if latest_diet %}
          <p class="small text-muted">Caricata il {{ latest_diet.uploaded_at.strftime('%Y-%m-%d') }}</p>
          <pre style="white-space: pre-wrap;">{{ latest_diet.content[:400] }}{% if latest_diet.content|length > 400 %}...{% endif %}</pre>
          <a href="{{ url_for('view_diet') }}" class="btn btn-outline-primary btn-sm">Visualizza dieta completa</a>
        {% else %}
          <p>Nessuna dieta caricata. <a href="{{ url_for('upload_diet') }}">Carica una dieta</a> per iniziare.</p>
        {% endif %}
      </div>
      <div class="col-md-6">
        <h4>Il tuo piano settimanale</h4>
        {% if latest_plan %}
          <p class="small text-muted">Generato il {{ latest_plan.created_at.strftime('%Y-%m-%d') }} per la settimana del {{ latest_plan.start_date.strftime('%Y-%m-%d') }}</p>
          <pre style="white-space: pre-wrap;">{{ latest_plan.content[:400] }}{% if latest_plan.content|length > 400 %}...{% endif %}</pre>
          <a href="{{ url_for('view_plan') }}" class="btn btn-outline-primary btn-sm">Visualizza piano completo</a>
        {% else %}
          <p>Nessun piano generato. Premi "Generate Plan" nel menu per creare il tuo primo piano.</p>
        {% endif %}
      </div>
    </div>
  </div>
{% endblock %}